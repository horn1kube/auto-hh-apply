# Оценка вакансий с помощью LLM

Добавлена новая функциональность для оценки соответствия вакансий и пользователей с использованием локальной LLM (Ollama).

## Возможности

- **Автоматическая загрузка вакансий** с hh.ru по ID
- **Парсинг данных вакансии**: название, компания, локация, зарплата, навыки, описание
- **Оценка с помощью LLM**: использование Ollama для анализа соответствия
- **Эвристическая оценка**: fallback без LLM
- **Веб-интерфейс**: удобная форма для оценки
- **CLI**: командная строка для тестирования

## Требования

1. **Ollama** (опционально, для LLM оценки)
   ```bash
   # Установка Ollama
   curl -fsSL https://ollama.ai/install.sh | sh
   
   # Загрузка модели
   ollama pull llama2
   ```

2. **Chrome/Chromium** (для парсинга вакансий)

## Использование

### 1. Веб-интерфейс

1. Запустите приложение:
   ```bash
   ./gradlew bootRun
   ```

2. Откройте http://localhost:8080

3. В разделе "Оценка вакансии":
   - Введите ID вакансии (например: 12345678)
   - Вставьте JSON профиля пользователя
   - Нажмите "Оценить вакансию"

### 2. CLI

```bash
# Сборка
./gradlew build

# Запуск CLI
java -cp build/libs/AutoVacancyReply-1.0.0-standalone.jar app.cli.EvaluationCli 12345678 examples/user.sample.json
```

### 3. Пример профиля пользователя

Создайте файл `examples/user.sample.json`:

```json
{
  "fullName": "Иван Петров",
  "summary": "Java-разработчик с 5 годами опыта",
  "skills": ["Java", "Spring Boot", "PostgreSQL"],
  "experienceYears": 5,
  "stack": ["Java 17", "Spring Boot 3.x", "Docker"],
  "preferredLocations": ["Москва", "Санкт-Петербург"],
  "preferredWorkFormat": "hybrid",
  "salaryExpectations": {
    "min": 150000,
    "max": 250000,
    "current": 180000
  },
  "languages": {
    "Русский": "Родной",
    "Английский": "B2"
  },
  "extras": {
    "teamSize": "5-10 человек",
    "projectTypes": "Веб-приложения"
  }
}
```

## Результат оценки

Оценка включает:

1. **Вакансия → Кандидат** (0-100): насколько вакансия подходит пользователю
2. **Кандидат → Вакансия** (0-100): насколько пользователь подходит вакансии
3. **Отсутствующие навыки**: список навыков, которых не хватает
4. **Рекомендация**: "Apply" или "Skip"
5. **Уверенность**: процент уверенности в оценке

## Архитектура

### Модели данных

- `Vacancy`: данные вакансии (название, компания, навыки, описание)
- `UserProfile`: профиль пользователя (навыки, опыт, предпочтения)
- `EvaluationResult`: результат оценки (скоры, причины, рекомендация)

### Сервисы

- `VacancyEvaluationService`: основной сервис оценки
- `TextUtils`: утилиты для работы с текстом
- `SkillMatcher`: сравнение навыков

### Утилиты

- **Парсинг HTML**: Jsoup для извлечения данных с hh.ru
- **HTTP клиент**: для загрузки страниц вакансий
- **Ollama API**: для вызова локальной LLM
- **JSON обработка**: Jackson для сериализации

## Настройка

### Ollama

По умолчанию используется:
- URL: `http://localhost:11434`
- Модель: `llama2`
- Температура: `0.1`

### Парсинг вакансий

Используются CSS селекторы для извлечения данных:
- Заголовок: `h1`
- Компания: `[data-qa='vacancy-company-name']`
- Описание: `[data-qa='vacancy-description']`

## Fallback

Если Ollama недоступна, используется эвристическая оценка:
- Сравнение навыков
- Анализ локации
- Проверка формата работы
- Низкая уверенность (50%)

## Логирование

Все операции логируются с помощью SLF4J/Logback:
- Загрузка вакансий
- Вызовы Ollama
- Результаты оценки
- Ошибки парсинга

## Тестирование

```bash
# Запуск тестов
./gradlew test

# Сборка с тестами
./gradlew build
```

## Примеры использования

### Оценка конкретной вакансии

```bash
java -cp build/libs/AutoVacancyReply-1.0.0-standalone.jar \
  app.cli.EvaluationCli 12345678 examples/user.sample.json
```

### Веб-интерфейс

1. Откройте http://localhost:8080
2. Введите ID вакансии
3. Вставьте JSON профиля
4. Получите результат

## Устранение неполадок

### Ollama недоступна

- Проверьте, что Ollama запущена: `ollama list`
- Проверьте порт: `curl http://localhost:11434/api/tags`
- Используется эвристическая оценка

### Ошибки парсинга

- Проверьте ID вакансии
- Убедитесь, что вакансия существует
- Проверьте доступность hh.ru

### Проблемы с Chrome

- Установите Chrome/Chromium
- Проверьте права доступа
- Обновите драйвер

## Разработка

### Добавление новых полей

1. Обновите модель `Vacancy`
2. Добавьте парсинг в `VacancyEvaluationService`
3. Обновите промпт для LLM

### Изменение логики оценки

1. Отредактируйте `evaluateWithHeuristics()`
2. Обновите промпт в `buildPrompt()`
3. Добавьте новые критерии

### Интеграция с другими LLM

1. Создайте новый клиент (аналог Ollama)
2. Обновите `VacancyEvaluationService`
3. Добавьте конфигурацию 